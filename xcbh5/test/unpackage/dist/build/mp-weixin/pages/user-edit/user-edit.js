(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user-edit/user-edit"],{"22b7":function(e,n,t){"use strict";t.r(n);var o=t("3f30"),i=t.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(a);n["default"]=i.a},"3f30":function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=t("6213"),i=t("871e"),a={data:function(){return{user:{Headimgurl:"",nickname:"",phone:"",sex:""},sexOptions:["未知","男","女"],isSubmitting:!1}},onLoad:function(){var n=this,t=e.getStorageSync("token");t?o.api.getUserProfile(t).then((function(e){console.log("用户数据:",e.data),n.user=e.data,n.user.nickname=e.data.name,n.user.sex=n.mapSexFromBackend(e.data.sex)})).catch((function(n){console.error("获取用户数据失败",n),e.showToast({title:"获取用户数据失败",icon:"none"})})):e.showToast({title:"请先登录",icon:"none"})},methods:{handleSexChange:function(e){this.user.sex=Number(e.detail.value)},mapSexFromBackend:function(e){return 2===e?2:1===e?1:0},mapSexToBackend:function(e){return 2===e?2:1===e?1:0},chooseImage:function(){var n=this;e.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){var t=e.tempFilePaths;if(t.length>0){console.log(t);var o=(0,i.useUpload)({uploadPath:"/group1/upload",tempFilePaths:t[0]}),a=o.upload;o.request;a().then((function(e){n.user.Headimgurl=e}))}}})},submitForm:function(){var n=this,t=e.getStorageSync("token");t?(this.isSubmitting=!0,o.api.editUserProfile(t,this.user).then((function(n){console.log("修改成功",n),e.showToast({title:"修改成功",icon:"success"})})).catch((function(n){console.error("修改失败",n),e.showToast({title:"修改失败",icon:"none"})})).finally((function(){n.isSubmitting=!1}))):e.showToast({title:"请先登录",icon:"none"})}}};n.default=a}).call(this,t("df3c")["default"])},5721:function(e,n,t){"use strict";t.r(n);var o=t("b77e"),i=t("22b7");for(var a in i)["default"].indexOf(a)<0&&function(e){t.d(n,e,(function(){return i[e]}))}(a);t("8be0");var u=t("828b"),c=Object(u["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);n["default"]=c.exports},"8be0":function(e,n,t){"use strict";var o=t("f7aa"),i=t.n(o);i.a},b77e:function(e,n,t){"use strict";t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return a})),t.d(n,"a",(function(){return o}));var o={uniIcons:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(t.bind(null,"15f4f"))}},i=function(){var e=this.$createElement;this._self._c},a=[]},f5f9:function(e,n,t){"use strict";(function(e,n){var o=t("47a9");t("2864");o(t("3240"));var i=o(t("5721"));e.__webpack_require_UNI_MP_PLUGIN__=t,n(i.default)}).call(this,t("3223")["default"],t("df3c")["createPage"])},f7aa:function(e,n,t){}},[["f5f9","common/runtime","common/vendor"]]]);