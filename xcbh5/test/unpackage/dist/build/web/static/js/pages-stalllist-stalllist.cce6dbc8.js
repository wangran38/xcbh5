(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-stalllist-stalllist"],{"0829":function(t,e,n){"use strict";var i=n("8bdb"),a=n("ea07").entries;i({target:"Object",stat:!0},{entries:function(t){return a(t)}})},3148:function(t,e,n){var i=n("b35a");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var a=n("967d").default;a("4a75f8fa",i,!0,{sourceMap:!1,shadowMode:!1})},5075:function(t,e,n){"use strict";var i=n("ae5c"),a=n("71e9"),o=n("e7e3"),r=n("52df"),s=n("81a7"),c=n("1fc1"),l=n("1297"),u=n("d67c"),d=n("5112"),f=n("7e91"),p=TypeError,h=function(t,e){this.stopped=t,this.result=e},v=h.prototype;t.exports=function(t,e,n){var g,b,w,m,x,y,k,S=n&&n.that,_=!(!n||!n.AS_ENTRIES),E=!(!n||!n.IS_RECORD),P=!(!n||!n.IS_ITERATOR),C=!(!n||!n.INTERRUPTED),T=i(e,S),D=function(t){return g&&f(g,"normal",t),new h(!0,t)},L=function(t){return _?(o(t),C?T(t[0],t[1],D):T(t[0],t[1])):C?T(t,D):T(t)};if(E)g=t.iterator;else if(P)g=t;else{if(b=d(t),!b)throw new p(r(t)+" is not iterable");if(s(b)){for(w=0,m=c(t);m>w;w++)if(x=L(t[w]),x&&l(v,x))return x;return new h(!1)}g=u(t,b)}y=E?t.next:g.next;while(!(k=a(y,g)).done){try{x=L(k.value)}catch(j){f(g,"throw",j)}if("object"==typeof x&&x&&l(v,x))return x}return new h(!1)}},"578c":function(t,e,n){"use strict";n("6a54");var i=n("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i(n("2634")),o=i(n("2fdc")),r=i(n("9b1b")),s=i(n("5de6"));n("fb2c"),n("8f71"),n("bf0f"),n("0829"),n("7a76"),n("c9b5"),n("c223");var c={data:function(){return{page:1,limit:8,totalnum:0,pageData:[],pageLoading:!1,hasMore:!0,searchParams:{}}},computed:{queryParams:function(){var t=Object.fromEntries(Object.entries(this.searchParams).filter((function(t){var e=(0,s.default)(t,2),n=(e[0],e[1]);return""!==n})));return(0,r.default)({page:this.page,limit:this.limit},t)}},methods:{loadPageData:function(){var t=this;return(0,o.default)((0,a.default)().mark((function e(){var n;return(0,a.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.hasMore&&!t.pageLoading){e.next=2;break}return e.abrupt("return");case 2:return t.pageLoading=!0,e.prev=3,e.next=6,t.fetchData(t.queryParams);case 6:n=e.sent,t.querySuccess(n),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](3),t.handleFetchError(e.t0);case 13:return e.prev=13,t.pageLoading=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[3,10,13,16]])})))()},fetchData:function(t){return(0,o.default)((0,a.default)().mark((function t(){return(0,a.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:throw new Error("fetchData 方法未实现");case 1:case"end":return t.stop()}}),t)})))()},querySuccess:function(t){null!==t&&void 0!==t&&t.listdata&&(this.pageData=1===this.page?t.listdata:this.pageData.concat(t.listdata),this.totalnum=t.totalnum||0,this.hasMore=this.pageData.length<this.totalnum)},handleScrollToLower:function(){!this.pageLoading&&this.hasMore&&(this.page+=1,this.loadPageData())},handleFetchError:function(t){console.error("Error loading data:",t)},resetPagination:function(){this.page=1,this.pageData=[],this.totalnum=0,this.hasMore=!0},reloadData:function(){this.resetPagination(),this.loadPageData()}}};e.default=c},"5eae":function(t,e,n){"use strict";var i=n("3148"),a=n.n(i);a.a},8413:function(t,e,n){"use strict";n.r(e);var i=n("a60b"),a=n.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=a.a},"871e":function(t,e,n){"use strict";n("6a54");var i=n("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.useUpload=void 0;var a=i(n("2634")),o=i(n("2fdc"));n("bf0f");var r=i(n("6213"));e.useUpload=function(t){var e=t.uploadPath,n=t.tempFilePaths,i=t.FormData,s=t.file;return{upload:function(){return new Promise(function(){var t=(0,o.default)((0,a.default)().mark((function t(o,c){return(0,a.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:uni.showLoading({title:"上传中",mask:!0}),uni.uploadFile({url:r.default.UPLOAD_URL+e,name:"file",file:s,filePath:n,formData:i,header:{},success:function(t){uni.showToast({title:"上传成功"}),uni.hideLoading(),o(null===t||void 0===t?void 0:t.data)},fail:function(t){console.log(t),uni.showToast({title:"上传失败",icon:"error"}),uni.hideLoading()}});case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}}}},a60b:function(t,e,n){"use strict";n("6a54");var i=n("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i(n("2634")),o=i(n("9b1b")),r=i(n("2fdc")),s=n("6213"),c=i(n("578c")),l=n("871e"),u={data:function(){return{pageData:[],shopList:[],token:"",imageUploaded:!1,showEditPopup:!1,currentShopTitle:"",currentShopLogo:"",isloaded:!1}},mixins:[c.default],onLoad:function(){this.isloaded=!0},created:function(){this.token=uni.getStorageSync("token"),this.reloadData()},methods:{fetchData:function(t){var e=this;return(0,r.default)((0,a.default)().mark((function n(){var i;return(0,a.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,s.api.getMyShops((0,o.default)({token:e.token},t));case 3:return i=n.sent,n.abrupt("return",i.data);case 7:n.prev=7,n.t0=n["catch"](0),console.error("获取摊位列表失败",n.t0),uni.showToast({title:"获取摊位列表失败",icon:"none"});case 11:case"end":return n.stop()}}),n,null,[[0,7]])})))()},editShop:function(t){this.currentShopId=t.id,this.currentShopTitle=t.title,this.currentShopLogo=t.logo,this.showEditPopup=!0},closePopup:function(){this.showEditPopup=!1},confirmEdit:function(t){var e=this;return(0,r.default)((0,a.default)().mark((function t(){var n;return(0,a.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.currentShopTitle){t.next=3;break}return uni.showToast({title:"请输入摊位名称",icon:"none"}),t.abrupt("return");case 3:if(e.imageUploaded||e.currentShopLogo){t.next=6;break}return uni.showToast({title:"请上传图片",icon:"none"}),t.abrupt("return");case 6:return t.prev=6,console.log("Calling editshop API"),t.next=10,s.api.editshop({id:e.currentShopId,title:e.currentShopTitle,logo:e.currentShopLogo});case 10:n=t.sent,200===n.code?(uni.showToast({title:"摊位信息修改成功",icon:"success"}),e.reloadData(),e.closePopup()):uni.showToast({title:n.msg||"摊位信息修改失败",icon:"none"}),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](6),uni.showToast({title:"修改失败，请稍后重试",icon:"none"});case 17:case"end":return t.stop()}}),t,null,[[6,14]])})))()},uploadcuisine:function(){var t=this;uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){var n=e.tempFilePaths;if(n.length>0){var i=(0,l.useUpload)({uploadPath:"/group1/upload",tempFilePaths:n[0]}),a=i.upload;i.request;a().then((function(e){console.log(e),t.currentShopLogo=e,console.log("更新后的图片路径:",t.currentShopLogo),t.isImageSelected=!0,t.imageUploaded=!0}))}}})},gotostaldis:function(t){uni.navigateTo({url:"/pages/Stalls-dishes/Stalls-dishes?id=".concat(t)})}}};e.default=u},b35a:function(t,e,n){var i=n("c86c");e=i(!1),e.push([t.i,".me-container[data-v-5d3846cb]{overflow:hidden;width:100%;box-sizing:border-box;padding:%?0?% %?30?% 0 %?30?%;color:#fff;z-index:1;background-color:#f4f4f4;display:flex;flex-direction:column;justify-content:center}.item-list[data-v-5d3846cb]{height:%?200?%;width:100%;margin-top:%?15?%;display:flex;flex-direction:row;justify-content:flex-start;align-items:center;background-color:#fff;border-radius:%?20?%}.logo[data-v-5d3846cb]{height:%?180?%;width:30%;text-align:center;line-height:%?200?%;background-color:#1296db;border-radius:%?20?%\n\t/* padding: 10rpx 10rpx; */}.logos[data-v-5d3846cb]{height:%?180?%;width:100%;border-radius:%?20?%}.info[data-v-5d3846cb]{height:%?200?%;width:50%;margin-left:%?10?%;\n\t/* 设置info和logo之间的间距 */display:flex;flex-direction:column;\n\t/* justify-content: space-between; */flex:1;\n\t/* 确保info占据剩余空间 */overflow:hidden\n\t/* 确保内容不溢出 */}.message[data-v-5d3846cb]{width:100%;margin:%?10?%;\n\t/* 调整这个值以改变上下间距 */color:#000;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.interface[data-v-5d3846cb]{height:100%;width:20%;display:flex;flex-direction:column;justify-content:center;align-items:center;margin-left:auto;\n\t/* 设置interface与info的间距 */position:relative\n\t/* margin-right: 0rpx; */\n\t/* background-color: #1296db; */}.interface>.edit[data-v-5d3846cb]{text-align:center;color:#fff;font-size:%?30?%;width:%?100?%;height:%?50?%;line-height:%?50?%;background-color:#1296db;border-radius:%?20?%;margin-bottom:%?20?%}.interface>.delete[data-v-5d3846cb]{text-align:center;color:#fff;font-size:%?30?%;width:%?100?%;height:%?50?%;line-height:%?50?%;background-color:#ff1909;border-radius:%?20?%}.loading[data-v-5d3846cb]{text-align:center;padding:%?20?%;color:#999}.popup-overlay[data-v-5d3846cb]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center;z-index:1000;color:#000}.popup[data-v-5d3846cb]{position:relative;width:80%;max-width:%?600?%;background-color:#fff;border-radius:%?20?%;padding:%?20?%;box-shadow:0 0 15px rgba(0,0,0,.2)}.popup-header[data-v-5d3846cb]{font-size:%?36?%;font-weight:700;margin-bottom:%?20?%;text-align:center}.popup-content[data-v-5d3846cb]{\n\t/* 这里你可以添加弹出层内容的样式 */display:flex;width:100%;padding:%?30?%;box-sizing:border-box;justify-content:center;align-items:center}.popup-footer[data-v-5d3846cb]{display:flex;justify-content:space-between;margin-top:%?10?%}.close-button[data-v-5d3846cb]{position:absolute;top:%?5?%;right:%?5?%;font-size:%?40?%;color:#000;cursor:pointer;z-index:10;width:%?80?%;height:%?80?%;display:flex;justify-content:center;align-items:center;background-color:#fff;border-radius:50%;box-shadow:0 0 %?10?% rgba(0,0,0,.1)}.cimg[data-v-5d3846cb]{width:%?100?%;height:%?100?%}.content[data-v-5d3846cb]{width:100%;height:%?200?%}.cuisine[data-v-5d3846cb]{width:100%;height:%?100?%;display:flex;justify-content:space-between;align-items:center}.editimg[data-v-5d3846cb]{width:100%;height:%?100?%;display:flex;justify-content:space-between;align-items:center}.title[data-v-5d3846cb]{font-size:%?35?%}.shuru[data-v-5d3846cb]{width:auto;height:%?100?%;display:flex;justify-content:end;align-items:center}.shurucon[data-v-5d3846cb]{text-align:end;font-size:%?35?%}",""]),t.exports=e},cc18:function(t,e,n){"use strict";n.r(e);var i=n("fb38"),a=n("8413");for(var o in a)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(o);n("5eae");var r=n("828b"),s=Object(r["a"])(a["default"],i["b"],i["c"],!1,null,"5d3846cb",null,!1,i["a"],void 0);e["default"]=s.exports},fb2c:function(t,e,n){"use strict";var i=n("8bdb"),a=n("5075"),o=n("85f7");i({target:"Object",stat:!0},{fromEntries:function(t){var e={};return a(t,(function(t,n){o(e,t,n)}),{AS_ENTRIES:!0}),e}})},fb38:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"me-container"},[n("v-uni-scroll-view",{staticClass:"Stallholder",style:{height:"100vh"},attrs:{"scroll-y":"true"},on:{scrolltolower:function(e){arguments[0]=e=t.$handleEvent(e),t.handleScrollToLower.apply(void 0,arguments)}}},[t._l(t.pageData,(function(e){return n("v-uni-view",{key:e.id,staticClass:"item-list"},[n("v-uni-view",{staticClass:"logo",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.gotostaldis(e.id)}}},[t.isloaded?n("v-uni-image",{staticClass:"logos",attrs:{"lazy-load":!0,src:e.logo,mode:"aspectFill"}}):t._e()],1),n("v-uni-view",{staticClass:"info",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.gotostaldis(e.id)}}},[n("v-uni-view",{staticClass:"message"},[t._v("菜市场名称："+t._s(e.market_name))]),n("v-uni-view",{staticClass:"message"},[t._v("摊位名称："+t._s(e.title))]),n("v-uni-view",{staticClass:"message"},[t._v("摊位编号："+t._s(e.id))])],1),n("v-uni-view",{staticClass:"interface"},[n("v-uni-view",{staticClass:"edit",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.editShop(e)}}},[t._v("编辑")]),n("v-uni-view",{staticClass:"delete",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.deleteShop.apply(void 0,arguments)}}},[t._v("删除")])],1)],1)})),t.pageLoading?n("v-uni-view",{staticClass:"loading"},[t._v("加载中...")]):t._e(),t.hasMore?t._e():n("v-uni-view",{staticClass:"loading"},[t._v("没有更多了")])],2),t.showEditPopup?n("v-uni-view",{staticClass:"popup-overlay",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"popup",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e)}}},[n("v-uni-view",{staticClass:"close-button",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[t._v("×")]),n("v-uni-view",{staticClass:"popup-content"},[n("v-uni-view",{staticClass:"content"},[n("v-uni-view",{staticClass:"cuisine"},[n("v-uni-view",{staticClass:"title"},[t._v("摊位名称")]),n("v-uni-view",{staticClass:"shuru"},[n("v-uni-input",{staticClass:"shurucon",attrs:{type:"text"},model:{value:t.currentShopTitle,callback:function(e){t.currentShopTitle=e},expression:"currentShopTitle"}})],1)],1),n("v-uni-view",{staticClass:"editimg"},[n("v-uni-view",{staticClass:"title"},[t._v("摊位图片")]),n("v-uni-image",{staticClass:"cimg",attrs:{src:t.currentShopLogo,mode:"aspectFit"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.uploadcuisine.apply(void 0,arguments)}}})],1)],1)],1),n("v-uni-view",{staticClass:"popup-footer"},[n("v-uni-button",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[t._v("取消")]),n("v-uni-button",{staticStyle:{"background-color":"#007aff",color:"white"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.confirmEdit.apply(void 0,arguments)}}},[t._v("确认")])],1)],1)],1):t._e()],1)},a=[]}}]);